flowchart TD
    Start([“SMT工单下达”]) --> A[“SMT产线准备”]
    
    subgraph A_Sub [准备流程]
        direction TB
        A1[“钢网准备<br>• 钢网编号&版本验证<br>• 钢网外观检查<br>• 钢网张力检测-SPC”]
        A2[“锡膏管理--扫码追溯<br>• 锡膏寿命计算与先进先出<br>• 锡膏回温时间<br>• 搅拌记录<br>• 有效期”]
        A3[“物料备料<br>• 车间库物料扫码<br>• Feeder准备<br>• 物料核对<br>• 核对标签SN范围”]
        A4[“设备准备<br>• 贴片程序加载<br>• 设备参数设置<br>• 吸嘴准备<br>• 顶针设置说明”]
        
        A1 --> A2 --> A3 --> A4
    end
    
    A --> A1
    
    A4 --> B[“上料防错”]
    
    subgraph B_Sub [防错流程]
        direction TB
        B1[调取机器《物料站位表》]
        B2[“• 扫码验证<br>扫描物料二维码+机器站位二维码”]
        B3[“• 系统比对<br>扫码结果与调出的《物料站位表》作对比--逐行对比”]
        B4[“• 防错判断<br>物料/站位检查”]
        B5{“验证结果”}
        B6[“确认上料”]
        B7[“报警锁定”]
        B8[“异常处理”]
        
        B1 --> B2 --> B3 --> B4 --> B5
        B5 -- 正确 --> B6
        B5 -- 错误 --> B7
        B7 --> B8 --> B2
    end
    
    B --> B1
    B6 --> C[“首件确认”]
    
    subgraph C_Sub [首件流程--首件检查记录]
        direction TB
        C1[“首件贴装<br>生产2-3拼板”]
        C2[“SPI检测<br>锡膏厚度/面积”]
        C3[“回流焊接<br>监控温度曲线”]
        C4[“AOI检查<br>焊点质量检查”]
        C5[“首件检测<br>无丝印的物料”]
        
        C1 --> C2 --> C3 --> C4 --> C5
    end
    
    C --> C1
    
    C5 --> D{“首件合格?”}
    D -->|否| F[“参数调整”]
    D -->|是| E[“批量生产授权”]
   
    F --> C1
    
    E --> G[“批量生产监控”]
    
    subgraph G_Sub [监控维度--数采]
        direction TB
        G1[“设备监控<br>• 贴片机OEE<br>• 抛料率<br>• 设备状态”]
        G2[“工艺监控<br>• 回流焊曲线<br>• 炉温实时监控<br>”]
        G3[“质量监控<br>• SPI直通率<br>• AOI直通率<br>• 不良模式分析”]
        G4[“物料监控<br>• 物料消耗<br>• 缺料预警<br>• 换料记录”]
        
        G1 --> G2 --> G3 --> G4
    end
    
    G --> G1
    
    G4 --> H[“数据综合分析• 决策判断”]
    H --> I{“生产完成?”}
    I -->|否| G
    I -->|是| J[“SMT完工处理”]
    
    J --> K([“转入DIP/测试工序”])