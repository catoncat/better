# Product UX Review: Loading（上料防错）

> 说明：本文件是 `product-ux-review` 的**轻量产出示例**（基于当前 UI 代码快速走查），用于展示 checklist 结构与粒度；后续可按实际 scope 再生成/迭代。

## 覆盖页面/组件证据
- `apps/web/src/routes/_authenticated/mes/loading/index.tsx`
- `apps/web/src/routes/_authenticated/mes/loading/slot-config.tsx`
- `apps/web/src/routes/_authenticated/mes/loading/-components/scan-panel.tsx`
- `apps/web/src/routes/_authenticated/mes/loading/-components/slot-list.tsx`
- `apps/web/src/routes/_authenticated/mes/loading/-components/loading-history.tsx`

## 1) 表单/操作效率
- ✅ 批次选择器支持搜索与上下文展示（RunNo/WO/Line），减少手输与误选成本。
- ✅ 扫码面板 `slotCode` 默认焦点；提交后清空物料条码、保留站位码，适合连续作业。
- ✅ 换料模式按需展开字段，并对换料原因/包装数量做前端校验，减少提交失败往返。
- ⚠️ P2: 站位码录入完成后未自动引导到“物料条码”输入 | 影响: 高频扫码多一次 Tab/点击 | 建议: `slotCode` 有值且触发 Enter/blur 后自动 focus 到 `materialLotBarcode`。
- ⚠️ P2: 从 SlotList “模拟扫码”填充后缺少下一步引导 | 影响: 用户不确定是否已填充成功/下一步动作 | 建议: 消费模拟数据后自动 focus 到物料条码或高亮“验证上料/确认换料”按钮。
- ❌ P1: 选中批次后页面缺少“当前批次关键摘要”固定展示（WO/产品/产线/状态） | 影响: 跨批次作业易混淆、误操作风险高 | 建议: 在标题区或 ScanPanel 顶部展示 run 摘要，并提供“更换批次”快捷入口。

## 2) 空态/异常体验
- ✅ 权限不足时有明确 NoAccess 文案（Run 读权限 / 上料查看或验证权限）。
- ✅ Run 详情加载中展示 loading spinner；无效 runNo 有提示“未找到批次”。
- ⚠️ P2: “未找到批次”空态缺少可执行动作 | 影响: 用户需要手动回到上方修改 | 建议: 提供“清除批次/返回选择”按钮，并在清除后回到可操作状态。
- ✅ 站位期望为空时展示“初始化站位表”卡片，说明下一步并提供按钮。
- ⚠️ P2: SlotList/History 在加载/刷新时的反馈偏弱 | 影响: 用户误以为无数据或卡死 | 建议: 增加 skeleton/行级 loading，或在卡片内展示“正在加载站位/记录”。
- ⚠️ P2: 错误反馈建议统一“恢复路径” | 影响: 失败后用户不知道下一步去哪修复 | 建议: 对常见失败场景提供通用引导（重试/刷新/前往配置页/联系角色），不展开业务逻辑判定。

## 3) 信息架构（IA）
- ✅ 扫码作业与站位状态左右分栏（大屏），主任务聚焦明确。
- ✅ “初始化站位表”只在需要时出现，避免常态噪音。
- ⚠️ P2: 缺少站位状态总览与快速过滤 | 影响: 站位多时难以定位未上料/异常项 | 建议: SlotList 顶部加统计条（待上料/已上料/异常/锁定）+ 一键筛选。
- ⚠️ P2: 站位表信息密度与可读性可再优化 | 影响: 物料码较长时难比对 | 建议: 提供复制按钮/hover 展示全量、重要字段（站位/期望/当前）做等宽字体或对齐策略。
- ⚠️ P2: 历史记录与当前操作的关联弱 | 影响: 需要在页面底部来回滚动确认 | 建议: History 支持折叠/侧栏/按站位过滤，默认展示最近 N 条。

## 4) 功能划分与路由规划
- ✅ 执行与配置职责分离：`/mes/loading`（作业）与 `/mes/loading/slot-config`（配置）。
- ⚠️ P2: 执行页到配置页的“纠错入口”不够显眼 | 影响: 出现“缺配置/需调整”时不知道去哪 | 建议: 在失败/空态处提供“前往站位表配置”的显式 CTA（不讨论权限与状态机正确性）。
- ⚠️ P2: 执行页同时承载“初始化站位表”动作可能导致角色心智混淆 | 影响: 作业员误以为可在此完成配置 | 建议: 文案强调“仅初始化，不做配置”，并对无权限用户保持清晰的替代路径描述。
- ⚠️ P2: `runNo` 作为 query state 的深链接能力可产品化 | 影响: 上下游页面难直接把用户送到正确上下文 | 建议: 统一入口（从 Run/Readiness 跳转时带上 runNo，并在页面明显展示当前上下文）。
- ⚠️ P2: 后续如增加“异常处理/锁定排障”复杂度，建议演进为页内 tabs（作业/站位状态/历史/排障）以降低单页信息拥挤。

## 总结
- P1 共 1 项
- P2 共 9 项
