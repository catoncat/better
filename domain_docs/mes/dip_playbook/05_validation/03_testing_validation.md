# 测试验证清单

## 1. 概述
本文档提供 DIP 产线测试工序（ICT/FCT）的验证清单，用于验收测试和功能验证。

## 2. 测试配置验证

### 2.1 工位配置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| ICT 工位存在 | 查询工位列表 | DIP-A-ICT-01 存在 | | [ ] |
| FCT 工位存在 | 查询工位列表 | DIP-A-FCT-01 存在 | | [ ] |
| 工位类型正确 | 检查类型 | stationType = TEST | | [ ] |
| 工位顺序正确 | 检查顺序 | ICT < FCT | | [ ] |

### 2.2 测试程序配置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| ICT 程序存在 | 查询程序列表 | ICT-PRDA-V1 存在 | | [ ] |
| FCT 程序存在 | 查询程序列表 | FCT-PRDA-V1 存在 | | [ ] |
| 程序关联产品 | 检查 productId | 正确关联产品 | | [ ] |
| 程序关联工位 | 检查 stationId | 正确关联工位 | | [ ] |

### 2.3 测试夹具配置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| ICT 夹具存在 | 查询夹具列表 | ICT-JIG-* 存在 | | [ ] |
| FCT 夹具存在 | 查询夹具列表 | FCT-JIG-* 存在 | | [ ] |
| 夹具类型正确 | 检查类型 | ICT_JIG / FCT_JIG | | [ ] |
| 寿命配置正确 | 检查 maxLife | 有合理的寿命值 | | [ ] |

## 3. ICT 测试验证

### 3.1 测试执行
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 进站成功 | 扫码进站 | 创建进站记录 | | [ ] |
| 测试程序加载 | 检查测试 | 正确程序执行 | | [ ] |
| 出站 PASS | 测试通过 | 创建 PASS 记录 | | [ ] |
| 出站 FAIL | 测试失败 | 创建 FAIL 记录 | | [ ] |

### 3.2 测试记录
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 测试记录创建 | 查询记录 | TestRecord 存在 | | [ ] |
| 记录关联单件 | 检查 unitId | 正确关联 | | [ ] |
| 记录关联程序 | 检查 programId | 正确关联 | | [ ] |
| 结果记录正确 | 检查 result | PASS/FAIL 正确 | | [ ] |
| 失败项记录 | 检查 failedItems | FAIL 时有失败项 | | [ ] |

### 3.3 ICT 不良类型
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 开路登记 | 选择 ICT_OPEN | 创建不良记录 | | [ ] |
| 短路登记 | 选择 ICT_SHORT | 创建不良记录 | | [ ] |
| 参数偏差登记 | 选择 ICT_VALUE | 创建不良记录 | | [ ] |
| 缺件登记 | 选择 ICT_MISS | 创建不良记录 | | [ ] |

## 4. FCT 测试验证

### 4.1 测试执行
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 进站成功 | 扫码进站 | 创建进站记录 | | [ ] |
| 测试程序加载 | 检查测试 | 正确程序执行 | | [ ] |
| 出站 PASS | 测试通过 | 创建 PASS 记录 | | [ ] |
| 出站 FAIL | 测试失败 | 创建 FAIL 记录 | | [ ] |

### 4.2 测试记录
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 测试记录创建 | 查询记录 | TestRecord 存在 | | [ ] |
| 测试项记录 | 检查 testItems | 所有测试项记录 | | [ ] |
| 失败项明细 | 检查 failedItems | 失败项有明细 | | [ ] |

### 4.3 FCT 不良类型
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 电源异常登记 | 选择 FCT_POWER | 创建不良记录 | | [ ] |
| 通讯失败登记 | 选择 FCT_COMM | 创建不良记录 | | [ ] |
| IO 异常登记 | 选择 FCT_IO | 创建不良记录 | | [ ] |
| 功能异常登记 | 选择 FCT_FUNC | 创建不良记录 | | [ ] |

## 5. 测试段首件（IPQC）验证

| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 段首件提示 | 进入测试段 | 提示段首件检查 | | [ ] |
| 程序验证 | 检查测试程序 | 版本正确 | | [ ] |
| 夹具检查 | 检查测试夹具 | 状态正常 | | [ ] |
| 首件测试 | 执行首件测试 | 结果记录 | | [ ] |
| IPQC 记录 | 查看记录 | 创建 IPQC 记录 | | [ ] |

## 6. 测试返修验证

### 6.1 返修处置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 处置为返修 | 选择 REWORK | 创建返修任务 | | [ ] |
| 处置为报废 | 选择 SCRAP | 单件 SCRAPPED | | [ ] |
| 处置为复测 | 选择 RETEST | 允许重新测试 | | [ ] |

### 6.2 复测流程
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 复测进站 | 返修后重进站 | 允许进站 | | [ ] |
| 复测记录 | 查看测试记录 | 有复测记录 | | [ ] |
| 复测次数 | 多次复测 | 记录复测次数 | | [ ] |
| 复测限制 | 超过次数限制 | 升级到 MRB | | [ ] |

## 7. 测试夹具验证

### 7.1 夹具分配
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 夹具可分配 | 分配到批次 | 分配成功 | | [ ] |
| 产品匹配检查 | 错误产品夹具 | 拒绝分配 | | [ ] |
| 寿命检查 | 寿命超限 | 警告或拒绝 | | [ ] |

### 7.2 夹具使用
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 使用记录 | 检查使用记录 | 每次使用记录 | | [ ] |
| 寿命累加 | 检查 currentLife | 正确累加 | | [ ] |

## 8. 测试数据验证

### 8.1 数据完整性
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 测试结果完整 | 查询记录 | 所有字段有值 | | [ ] |
| 测试时间正确 | 检查时间 | 时间合理 | | [ ] |
| 失败明细完整 | 检查 failedItems | FAIL 有明细 | | [ ] |

### 8.2 数据查询
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 按单件查询 | 按 unitId 查询 | 返回测试历史 | | [ ] |
| 按批次查询 | 按 runId 查询 | 返回批次所有测试 | | [ ] |
| 按程序查询 | 按 programId 查询 | 返回程序使用记录 | | [ ] |

## 9. 测试统计验证

| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 测试通过率 | 统计 PASS/FAIL | 计算正确 | | [ ] |
| 一次通过率 | 统计首次通过 | 计算正确 | | [ ] |
| 不良分布 | 按不良类型统计 | 统计正确 | | [ ] |
| 趋势分析 | 按时间统计 | 趋势正确 | | [ ] |

## 10. API 验证

### 10.1 执行 API
```
POST /api/stations/:stationCode/track-in
POST /api/stations/:stationCode/track-out

验证:
- [ ] ICT 工位正常
- [ ] FCT 工位正常
- [ ] 测试结果正确记录
```

### 10.2 测试记录 API
```
POST /api/test-records
GET /api/test-records

验证:
- [ ] 创建测试记录返回 201
- [ ] 查询按单件筛选正常
- [ ] 查询按批次筛选正常
```

### 10.3 不良处置 API
```
POST /api/defects/:defectId/disposition

验证:
- [ ] 返修处置正常
- [ ] 报废处置正常
- [ ] 复测处置正常
```
