# 追溯验证清单

## 1. 概述
本文档提供 DIP 产线追溯功能的验证清单，确保从单件到批次、从物料到工艺的完整追溯能力。

## 2. 单件追溯验证

### 2.1 基本信息追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 单件存在 | 输入序列号查询 | 返回单件信息 | | [ ] |
| 批次关联 | 检查 runId | 正确关联批次 | | [ ] |
| 产品关联 | 检查 productId | 正确关联产品 | | [ ] |
| 工单关联 | 检查 workOrderId | 正确关联工单 | | [ ] |

### 2.2 生产历史追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 插件记录 | 查询执行记录 | 显示插件工位记录 | | [ ] |
| 焊接记录 | 查询执行记录 | 显示焊接工位记录 | | [ ] |
| 后焊记录 | 查询执行记录 | 显示后焊工位记录 | | [ ] |
| 测试记录 | 查询执行记录 | 显示测试工位记录 | | [ ] |
| 时间顺序 | 检查时间 | 按时间正序排列 | | [ ] |

### 2.3 测试数据追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| ICT 测试结果 | 查询测试记录 | 显示 ICT 结果 | | [ ] |
| FCT 测试结果 | 查询测试记录 | 显示 FCT 结果 | | [ ] |
| 测试明细 | 查看测试项 | 显示各项结果 | | [ ] |
| 失败项明细 | 查看失败项 | 显示失败原因 | | [ ] |

### 2.4 不良与返修追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 不良记录 | 查询不良历史 | 显示所有不良 | | [ ] |
| 不良位置 | 检查位置信息 | 显示不良位置 | | [ ] |
| 返修记录 | 查询返修历史 | 显示返修详情 | | [ ] |
| 返修结果 | 检查返修结果 | 显示返修后状态 | | [ ] |

## 3. 批次追溯验证

### 3.1 批次基本信息
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 批次存在 | 输入批次号查询 | 返回批次信息 | | [ ] |
| 工单关联 | 检查 workOrderId | 正确关联 | | [ ] |
| 产线关联 | 检查 lineId | 正确关联 | | [ ] |
| 路由关联 | 检查 routeVersionId | 正确关联 | | [ ] |

### 3.2 批次单件追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 单件列表 | 查询批次单件 | 显示所有单件 | | [ ] |
| 单件状态统计 | 统计各状态数量 | 数量正确 | | [ ] |
| 良品追溯 | 筛选 DONE 单件 | 显示良品列表 | | [ ] |
| 不良品追溯 | 筛选 DEFECTIVE | 显示不良品列表 | | [ ] |

### 3.3 批次质量追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| FAI 记录 | 查询 FAI | 显示首件记录 | | [ ] |
| IPQC 记录 | 查询 IPQC | 显示巡检记录 | | [ ] |
| OQC 记录 | 查询 OQC | 显示 OQC 记录 | | [ ] |
| MRB 决策 | 查询 MRB | 显示决策记录 | | [ ] |

### 3.4 批次夹具追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 夹具分配记录 | 查询分配 | 显示使用的夹具 | | [ ] |
| 波峰焊治具 | 检查治具记录 | 显示治具信息 | | [ ] |
| 测试夹具 | 检查测试夹具 | 显示夹具信息 | | [ ] |

## 4. 夹具追溯验证

### 4.1 夹具使用追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 使用历史 | 按夹具查询 | 显示使用记录 | | [ ] |
| 使用批次 | 检查 runId | 显示关联批次 | | [ ] |
| 使用单件 | 检查 unitId | 显示关联单件 | | [ ] |
| 使用时间 | 检查时间 | 按时间排序 | | [ ] |

### 4.2 夹具寿命追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 寿命累计 | 检查 currentLife | 累计正确 | | [ ] |
| 使用次数统计 | 统计使用记录 | 与寿命一致 | | [ ] |
| 维护记录 | 查询维护历史 | 显示维护记录 | | [ ] |

### 4.3 夹具影响追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 影响单件查询 | 夹具问题时查询 | 返回使用过的单件 | | [ ] |
| 影响批次查询 | 夹具问题时查询 | 返回使用过的批次 | | [ ] |
| 时间范围筛选 | 按时间筛选 | 正确筛选 | | [ ] |

## 5. 工艺参数追溯

### 5.1 波峰焊参数
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 焊接温度 | 查询工艺数据 | 显示温度记录 | | [ ] |
| 传送速度 | 查询工艺数据 | 显示速度记录 | | [ ] |
| 参数与单件关联 | 检查关联 | 可追溯到单件 | | [ ] |

### 5.2 测试参数
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 测试程序版本 | 查询测试记录 | 显示程序版本 | | [ ] |
| 测试设备 | 查询测试记录 | 显示设备 ID | | [ ] |

## 6. 反向追溯验证

### 6.1 从不良追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 不良到单件 | 查询不良 | 显示单件信息 | | [ ] |
| 不良到批次 | 查询不良 | 显示批次信息 | | [ ] |
| 不良到工位 | 查询不良 | 显示发生工位 | | [ ] |
| 不良到夹具 | 查询不良 | 显示使用夹具 | | [ ] |

### 6.2 从夹具追溯
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 夹具到单件 | 输入夹具号查询 | 返回使用单件 | | [ ] |
| 夹具到批次 | 输入夹具号查询 | 返回使用批次 | | [ ] |
| 夹具到产品 | 检查产品关联 | 显示产品信息 | | [ ] |

## 7. 追溯报告验证

### 7.1 单件追溯报告
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 报告生成 | 生成追溯报告 | 报告生成成功 | | [ ] |
| 内容完整 | 检查报告内容 | 包含所有追溯项 | | [ ] |
| 导出功能 | 导出 PDF/Excel | 导出成功 | | [ ] |

### 7.2 批次追溯报告
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 报告生成 | 生成批次报告 | 报告生成成功 | | [ ] |
| 统计数据 | 检查统计项 | 统计正确 | | [ ] |
| 导出功能 | 导出 PDF/Excel | 导出成功 | | [ ] |

## 8. 追溯页面验证

### 8.1 追溯查询页面
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 单件查询 | 输入序列号 | 显示追溯结果 | | [ ] |
| 批次查询 | 输入批次号 | 显示追溯结果 | | [ ] |
| 条码扫描 | 扫描条码 | 自动查询 | | [ ] |
| 结果展示 | 查看结果 | 信息完整 | | [ ] |

### 8.2 时间线视图
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 时间线显示 | 查看单件追溯 | 显示时间线 | | [ ] |
| 节点完整 | 检查节点 | 所有工位都有节点 | | [ ] |
| 节点详情 | 点击节点 | 显示详情 | | [ ] |

## 9. API 验证

### 9.1 追溯查询 API
```
GET /api/trace/unit/:serialNo
GET /api/trace/run/:runNo

验证:
- [ ] 单件追溯返回完整数据
- [ ] 批次追溯返回完整数据
- [ ] 无效查询返回 404
```

### 9.2 夹具追溯 API
```
GET /api/tooling/:id/usage
GET /api/tooling/:id/impact

验证:
- [ ] 使用记录查询正常
- [ ] 影响范围查询正常
```

## 10. 边界场景验证

| 场景 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|----------|------|
| 新单件无记录 | 查询刚创建单件 | 显示基本信息 | | [ ] |
| 多次返修单件 | 查询多次返修 | 显示完整历史 | | [ ] |
| 报废单件 | 查询报废单件 | 显示报废前历史 | | [ ] |
| 大批次追溯 | 查询 1000+ 单件批次 | 响应时间合理 | | [ ] |
