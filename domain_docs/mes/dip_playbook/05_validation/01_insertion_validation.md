# 插件验证清单

## 1. 概述
本文档提供 DIP 产线插件工序的验证清单，用于验收测试和功能验证。

## 2. 配置验证

### 2.1 工位配置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| AI 插件工位存在 | 查询工位列表 | 工位 DIP-A-AI-01 存在 | | ☐ |
| 手工插件工位存在 | 查询工位列表 | 工位 DIP-A-MI-01 存在 | | ☐ |
| 异形件工位存在 | 查询工位列表 | 工位 DIP-A-OI-01 存在 | | ☐ |
| 工位类型正确 | 检查工位类型 | stationType = INSERTION | | ☐ |
| 工位顺序正确 | 检查工位顺序 | AI < 手工 < 异形 | | ☐ |

### 2.2 路由配置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 路由包含插件步骤 | 查询路由步骤 | 包含 3 个插件步骤 | | ☐ |
| 步骤顺序正确 | 检查步骤顺序 | 按 AI → 手工 → 异形 | | ☐ |
| 可选步骤配置 | 检查 required 字段 | 异形件可选 | | ☐ |

## 3. 执行流程验证

### 3.1 TrackIn 验证
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 扫码进站成功 | 扫描 PCB 条码 | 创建 TrackIn 记录 | | ☐ |
| 记录时间正确 | 检查 trackInTime | 时间为当前时间 | | ☐ |
| 操作员记录 | 检查 operatorId | 记录正确的操作员 | | ☐ |
| 重复进站拒绝 | 再次扫码 | 提示已进站 | | ☐ |
| 非授权批次拒绝 | PREP 状态批次 | 拒绝进站 | | ☐ |

### 3.2 TrackOut 验证
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 正常出站（PASS） | 点击完成 | 创建 PASS TrackOut | | ☐ |
| 不良出站（FAIL） | 登记不良 | 创建 FAIL TrackOut | | ☐ |
| 周期时间计算 | 检查 cycleTime | 正确计算耗时 | | ☐ |
| 未进站不能出站 | 直接出站 | 提示需先进站 | | ☐ |

### 3.3 工位流转验证
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 按顺序流转 | AI → 手工 | 允许流转 | | ☐ |
| 跳过可选工位 | AI → 波峰焊 | 允许（跳过异形件） | | ☐ |
| 逆向流转拒绝 | 手工 → AI | 拒绝或警告 | | ☐ |

## 4. 不良处理验证

### 4.1 不良登记
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 缺件登记 | 选择 INS_MISS | 创建不良记录 | | ☐ |
| 错件登记 | 选择 INS_WRONG | 创建不良记录 | | ☐ |
| 反极性登记 | 选择 INS_POLAR | 创建不良记录 | | ☐ |
| 位置描述 | 输入元件位号 | 记录位置信息 | | ☐ |
| 照片上传 | 上传不良照片 | 照片关联不良 | | ☐ |

### 4.2 不良处置
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 处置为返修 | 选择 REWORK | 创建返修任务 | | ☐ |
| 处置为报废 | 选择 SCRAP | 单件状态 SCRAPPED | | ☐ |
| 处置为让步 | 选择 ACCEPT | 继续流转 | | ☐ |

### 4.3 返修流程
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 返修任务可查询 | 查询返修列表 | 任务存在 | | ☐ |
| 执行返修 | 完成返修操作 | 记录返修动作 | | ☐ |
| 返修后复检 | 提交复检 | 复检结果记录 | | ☐ |
| 复检通过 | 复检 PASS | 继续流转 | | ☐ |
| 复检失败 | 复检 FAIL | 再次登记不良 | | ☐ |

## 5. 数据完整性验证

### 5.1 执行记录
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| TrackIn 记录完整 | 查询记录 | 所有字段有值 | | ☐ |
| TrackOut 记录完整 | 查询记录 | 所有字段有值 | | ☐ |
| 记录与单件关联 | 检查 unitId | 正确关联 | | ☐ |
| 记录与工位关联 | 检查 stationId | 正确关联 | | ☐ |

### 5.2 不良记录
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 不良记录完整 | 查询记录 | 所有必填字段有值 | | ☐ |
| 不良与单件关联 | 检查 unitId | 正确关联 | | ☐ |
| 不良与工位关联 | 检查 stationId | 正确关联 | | ☐ |
| 返修记录关联 | 检查返修任务 | 关联到不良 | | ☐ |

## 6. 页面功能验证

### 6.1 执行页面
| 验证项 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|----------|------|
| 工位选择 | 选择插件工位 | 正确显示工位 | | ☐ |
| 扫码输入 | 输入/扫描条码 | 触发进站 | | ☐ |
| 完成按钮 | 点击完成 | 触发出站 | | ☐ |
| 不良按钮 | 点击不良 | 打开不良登记 | | ☐ |
| 当前状态显示 | 查看状态 | 显示进站/出站状态 | | ☐ |

## 7. API 验证

### 7.1 进站 API
```
POST /api/stations/:stationCode/track-in

验证:
- [ ] 正常请求返回 200
- [ ] 缺少必填字段返回 400
- [ ] 无效工位返回 404
- [ ] 非授权批次返回 403
```

### 7.2 出站 API
```
POST /api/stations/:stationCode/track-out

验证:
- [ ] PASS 出站返回 200
- [ ] FAIL 出站返回 200
- [ ] 未进站出站返回 400
```

### 7.3 不良登记 API
```
POST /api/defects

验证:
- [ ] 正常请求返回 201
- [ ] 缺少必填字段返回 400
- [ ] 无效单件返回 404
```

## 8. 边界场景验证

| 场景 | 验证方法 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|----------|------|
| 并发进站 | 同时扫两块板 | 都能成功 | | ☐ |
| 快速连续操作 | 快速完成多块 | 都能成功 | | ☐ |
| 网络断开恢复 | 断网后重连 | 数据不丢失 | | ☐ |
| 长时间未操作 | 放置 30 分钟 | 继续操作正常 | | ☐ |
