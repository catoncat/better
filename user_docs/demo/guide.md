# MES 系统演示指南

---

## 一、项目进度概览

### 已完成里程碑

| 里程碑 | 完成时间 | 核心能力 |
|--------|----------|----------|
| **M1** | 2025-12-27 | 生产执行闭环：工单 → 批次 → 过站 → 追溯 |
| **M1.5-M1.8** | 2025-12-27 | ERP 集成、RBAC 权限、演示就绪 |
| **M2** | 2026-01-06 | 质量控制闭环：FAI、OQC、MRB、返修 |

### 当前进度 (M3 进行中)

- 上线准备：验收脚本、部署文档、数据采集配置
- 预计本周完成

### 核心能力一览

1. **SMT + DIP 双产线支持** - 覆盖贴片和插件全流程
2. **完整质量门禁** - 就绪检查 → 上料防错 → FAI → OQC → MRB
3. **全流程可追溯** - 单件级追溯，问题快速定位
4. **角色权限隔离** - 6 种角色，细粒度权限控制

---

## 二、端到端流程演示（12 分钟）

### 阶段 1：计划排产（4 分钟）

#### 页面：工单管理 `/mes/work-orders`

**展示要点：**
- 工单列表显示不同状态（待分配 / 已下发 / 执行中 / 已完成）
- 筛选器快速定位目标工单
- ERP 同步按钮（演示数据已自动同步）

**操作演示：**
1. 点击一个 `RECEIVED` 状态的工单（如 `WO-MGMT-SMT-QUEUE`）
2. 点击「下发」按钮
3. 选择目标产线
4. 演示状态变为 `RELEASED`

**讲解话术：**
> "工单从 ERP 系统自动同步过来，计划员可以一键下发到产线。下发后系统自动绑定路由和工序配置。"

---

#### 页面：批次管理 `/mes/runs`

**展示要点：**
- 批次列表显示不同状态（PREP / AUTHORIZED / IN_PROGRESS / ON_HOLD / COMPLETED）
- 批次与工单的关联关系
- 产线分组显示

**操作演示：**
1. 点击 `RUN-MGMT-SMT-EXEC`（执行中）
2. 进入批次详情页

**讲解话术：**
> "每个工单可以拆分为多个批次进行生产。批次详情页是车间组长的主操作界面。"

---

### 阶段 2：生产准备与质量门禁（4 分钟）

#### 页面：批次详情 `/mes/runs/{runNo}`

**展示要点：**
- 就绪检查卡片（路由、上料、设备、钢网、锡膏）
- FAI 首件检验区域
- 授权按钮（需 FAI 通过才能启用）

**操作演示：**
1. 展示 `RUN-MGMT-SMT-PREP`（准备中）- 就绪检查待执行
2. 展示 `RUN-MGMT-SMT-AUTH`（已授权）- FAI 已通过，可以生产

**讲解话术：**
> "批次必须通过就绪检查和首件检验才能授权生产。这确保了生产前的准备工作到位，降低批量不良风险。"

---

#### 页面：首件检验 `/mes/fai`

**展示要点：**
- FAI 任务列表
- 不同状态的 FAI（PENDING / PASS / FAIL）

**操作演示：**
1. 点击一个已完成的 FAI 查看详情
2. 展示检验项目和结果

**讲解话术：**
> "首件检验是质量的第一道门禁。检验员确认首件合格后，批次才能正式投产。"

---

### 阶段 3：执行与追溯（4 分钟）

#### 页面：工位执行 `/mes/execution`

**展示要点：**
- 当前工位在站单件列表
- 进站/出站操作区
- 工序进度可视化

**讲解话术：**
> "操作员在工位扫描单件进站，完成工序后扫描出站。系统自动记录时间、操作员、工位信息。"

---

#### 页面：追溯查询 `/mes/trace`

**展示要点：**
- 输入 SN 查询完整生产履历
- 路由版本快照
- 各工序过站记录
- 检验记录和结果

**操作演示：**
1. 输入 `SN-MGMT-DONE-0001`
2. 展示完整追溯信息

**讲解话术：**
> "这是系统的核心价值之一 —— 全流程可追溯。任何一个产品出问题，我们可以追溯到它经过了哪些工序、谁操作的、用了什么物料、检验结果如何。"

---

#### 页面：OQC 抽检 `/mes/oqc`

**展示要点：**
- OQC 任务列表
- PASS / FAIL 不同结果
- ON_HOLD 状态的批次（等待 MRB）

**操作演示：**
1. 点击一个 `FAIL` 状态的 OQC（对应 `RUN-MGMT-SMT-HOLD`）
2. 说明批次已锁定，等待 MRB 评审

**讲解话术：**
> "OQC 是出货前的最后一道质量关卡。如果抽检不合格，批次自动锁定，需要质量评审（MRB）决定是返修还是报废。"

---

## 三、系统亮点总结（5 分钟）

### 业务价值

| 价值维度 | 说明 |
|----------|------|
| **生产可控** | 全流程状态可视，异常实时预警 |
| **质量可追** | 单件级追溯，问题快速定位 |
| **风险可降** | 多级门禁（就绪/FAI/OQC/MRB），防呆防错 |
| **集成可靠** | 支持降级模式，不依赖外部系统 100% 在线 |

### 技术亮点

1. **现代化技术栈** - React 19 + TypeScript + Bun，开发效率高
2. **单机可部署** - 无需复杂的分布式架构，SQLite + 单可执行文件
3. **RBAC 权限** - 6 种角色，40+ 权限点，细粒度控制
4. **完整审计日志** - 所有操作可追溯
5. **双产线支持** - SMT 和 DIP 工艺流程完整覆盖

### 下一步计划

- **M3（本周）**: 上线准备 —— 验收脚本、部署文档、操作手册
- **M4（后续）**: 自动化执行 —— 设备对接、批量数据采集、自动过站

---

## 附录

### 演示账号

| 角色 | 账号 | 密码 | 主要功能 |
|------|------|------|----------|
| 管理员 | admin@example.com | ChangeMe123! | 系统配置、用户管理 |
| 计划员 | planner@example.com | Test123! | 工单管理、批次派发 |
| 工艺工程师 | engineer@example.com | Test123! | 路由配置、数据采集规格 |
| 质量员 | quality@example.com | Test123! | FAI/OQC/MRB、缺陷管理 |
| 组长 | leader@example.com | Test123! | 批次管理、就绪检查、授权 |
| 操作员 | operator@example.com | Test123! | 工位执行、进站/出站 |

### 演示前检查清单

- [ ] 运行 `bun run db:seed` 重置数据库
- [ ] 运行 `bun apps/server/scripts/seed-demo.ts` 创建演示数据
- [ ] 启动服务 `bun run dev`
- [ ] 打开浏览器访问 http://localhost:3001
- [ ] 使用 admin@example.com 登录验证
- [ ] 预先打开以下页面标签：
  - 工单管理 `/mes/work-orders`
  - 批次管理 `/mes/runs`
  - 追溯查询 `/mes/trace`

### 推荐演示数据

| 用途 | 工单号 | 批次号 | SN |
|------|--------|--------|-----|
| 待下发工单 | WO-MGMT-SMT-QUEUE | - | - |
| 准备中批次 | WO-MGMT-SMT-PREP | RUN-MGMT-SMT-PREP | - |
| 执行中批次 | WO-MGMT-SMT-EXEC | RUN-MGMT-SMT-EXEC | SN-MGMT-EXEC-0001 |
| 质量锁定批次 | WO-MGMT-SMT-HOLD | RUN-MGMT-SMT-HOLD | SN-MGMT-HOLD-0001 |
| 已完成追溯 | WO-MGMT-SMT-DONE | RUN-MGMT-SMT-DONE | **SN-MGMT-DONE-0001** |
| DIP 执行中 | WO-MGMT-DIP-EXEC | RUN-MGMT-DIP-EXEC | SN-MGMT-DIP-EXEC-0001 |

### 常见问题应对

**Q: 系统能支持多大的生产规模？**
> 单机版可支持日产万件级别。如需更大规模，架构可平滑升级到分布式部署。

**Q: 和现有 ERP 如何对接？**
> 系统已实现与金蝶云星空的对接接口，支持工单、物料、BOM、路由的自动同步。其他 ERP 可通过标准接口适配。

**Q: 上线需要多长时间？**
> 核心系统已具备上线条件。具体时间取决于：1) 产线配置 2) 操作员培训 3) ERP 对接调试。

**Q: 如果网络断了怎么办？**
> 系统支持降级模式。所有外部集成检查都可以手动豁免，确保生产不中断。事后可补录数据。
