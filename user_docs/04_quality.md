# 质量工程师 (Quality) 操作指南

## 角色概述

质量工程师负责生产过程中的质量检验、缺陷处置、追溯分析，确保产品质量符合标准。

| 属性 | 值 |
|------|-----|
| 角色代码 | `quality` |
| 数据范围 | 全部 (ALL) |
| 默认首页 | `/mes/trace` |

## 权限清单

### 质量管理
- ✓ 首件检验 (`quality:fai`)
- ✓ 出货检验 (`quality:oqc`)
- ✓ 缺陷处置 (`quality:disposition`)

### 追溯查询
- ✓ 追溯查询 (`trace:read`)
- ✓ 导出报告 (`trace:export`)

### 其他
- ✓ 查看工单 (`wo:read`)
- ✓ 查看批次 (`run:read`)
- ✓ 查看执行 (`exec:read`)

## 可访问菜单

```
生产执行
├── 工单管理      /mes/work-orders        [只读]
├── 批次管理      /mes/runs               [只读]
├── 准备异常      /mes/readiness-exceptions [查看]
├── 首件检验      /mes/fai                [完整操作]
├── 缺陷处置      /mes/defects            [完整操作]
├── 返工任务      /mes/rework-tasks       [完整操作]
├── 工位执行      /mes/execution          [只读]
└── 追溯查询      /mes/trace              [完整操作]

通知中心          /notifications
```

---

## 核心功能操作

### 1. 首件检验 (FAI)

首件检验是批次开始生产前的质量确认环节。MES 系统汇总外部检测数据（SPI/AOI）进行首件判定。

#### 1.1 查看待检列表
1. 导航至 **生产执行 → 首件检验**
2. 查看待检任务：
   - 批次信息
   - 产品型号
   - 关联工位
   - 等待时间

#### 1.2 首件判定流程

```
首件生产 (2-3拼板)
    │
    ▼
SPI 检测结果
├── 自动: 接收数采系统数据
└── 手动: 录入检测结果
    │
    ▼
回流焊接
    │
    ▼
AOI 检测结果
├── 自动: 接收数采系统数据
└── 手动: 录入检测结果
    │
    ▼
MES 汇总判定
    │
    ├── 全部 PASS → 首件通过，批次可授权
    └── 任一 FAIL → 首件不通过，需处置
```

#### 1.3 执行首件检验
1. 选择待检任务
2. 点击 **开始检验**
3. 查看检测数据：
   - SPI 结果（自动/手动）
   - AOI 结果（自动/手动）
   - 数据来源标识（`AUTO`/`MANUAL`）
4. 根据汇总结果判定：
   - **通过**: 批次可继续生产
   - **不通过**: 需要处置

#### 1.4 首件不通过处理
1. 选择不通过原因
2. 触发缺陷处置流程
3. 通知产线组长暂停生产
4. 跟踪整改情况
5. 安排复检（连续失败≥3次需工程师介入）

---

### 2. 缺陷处置

#### 2.1 查看缺陷列表
1. 导航至 **生产执行 → 缺陷处置**
2. 查看待处置缺陷：
   - 缺陷来源（首件检验/过程检验/终检）
   - 缺陷描述
   - 影响范围
   - 创建时间

#### 2.2 缺陷判定
1. 选择待处置缺陷
2. 点击 **处置**
3. 分析缺陷：
   - 查看缺陷详情
   - 查看关联产品追溯信息
   - 评估影响范围
   - 查看数据来源（`AUTO`/`MANUAL`）
4. 做出判定：

| 判定结果 | 说明 | 后续操作 | 单件状态 |
|----------|------|----------|----------|
| **放行** | 缺陷在可接受范围内 | 产品继续流转 | `QUEUED` |
| **返修** | 可通过返工修复 | 创建返修任务 | `OUT_FAILED → QUEUED` |
| **报废** | 无法修复 | 产品报废处理 | `SCRAPPED` |
| **隔离** | 需 MRB 评审 | 产品隔离等待 | `ON_HOLD` |

5. 填写处置意见
6. 确认提交

#### 2.3 批量处置
对于同批次的多个缺陷：
1. 勾选相关缺陷记录
2. 点击 **批量处置**
3. 统一做出判定
4. 确认提交

---

### 3. 返工任务管理

#### 3.1 查看返工任务
1. 导航至 **生产执行 → 返工任务**
2. 查看任务状态：
   - 待执行
   - 进行中
   - 已完成
   - 已关闭

#### 3.2 创建返工任务
缺陷判定为返工后自动创建，或手动创建：
1. 点击 **新建返工任务**
2. 填写信息：
   - 关联缺陷
   - 返工内容描述
   - 返工工序
   - 预期完成时间
3. 保存

#### 3.3 跟踪返工进度
1. 查看返工任务执行状态
2. 返工完成后进行复检
3. 复检通过后关闭任务

---

### 4. 追溯查询

#### 4.1 按序列号查询
1. 导航至 **生产执行 → 追溯查询**
2. 输入产品序列号
3. 查看完整追溯信息：
   - 生产履历（各工序时间、操作人）
   - 采集数据（各工序参数值）
   - 质检记录
   - 缺陷/返工记录
   - 物料信息
   - **数据来源标识**（`AUTO`/`MANUAL`）

> **数据来源说明**：
> - `AUTO`: 数据由外部系统（SPI/AOI/TPM/WMS）自动采集
> - `MANUAL`: 数据由操作员手动录入（降级模式）
> 
> 可通过数据来源统计手动录入占比，衡量自动化程度。

#### 4.2 按批次查询
1. 选择批次查询方式
2. 输入批次号
3. 查看批次下所有产品的追溯汇总

#### 4.3 条件筛选查询
1. 使用高级筛选：
   - 时间范围
   - 产品型号
   - 生产线
   - 缺陷类型
2. 查看符合条件的产品列表

#### 4.4 导出报告
1. 选择需要导出的追溯数据
2. 点击 **导出**
3. 选择导出格式：
   - PDF 报告
   - Excel 数据
4. 下载报告

---

## 工作流程

### 日常质检工作流

```
早班开始
    │
    ▼
查看待检任务（首件检验）
    │
    ▼
执行首件检验
    ├── 通过 → 批次正常生产
    └── 不通过 → 触发缺陷处置
            │
            ▼
处置缺陷
    ├── 放行
    ├── 返工 → 创建返工任务 → 跟踪 → 复检
    └── 报废
            │
            ▼
追溯分析（如需要）
    │
    ▼
导出质量报告
```

### 质量问题处理流程

```
接收质量问题通知
        │
        ▼
追溯查询定位问题
        │
        ▼
分析影响范围
        │
        ▼
做出处置决定
        │
        ▼
跟踪处置执行
        │
        ▼
验证问题解决
        │
        ▼
总结改进措施
```

---

## 常见场景

### 场景1: 首件检验发现问题
1. 记录详细缺陷信息
2. 通知产线组长暂停该批次
3. 分析问题原因
4. 与工艺工程师沟通（如涉及工艺问题）
5. 确定处置方案
6. 整改后复检

### 场景2: 客户投诉追溯
1. 根据客户提供的序列号查询追溯
2. 导出完整生产履历
3. 分析可能的问题环节
4. 追溯同批次其他产品
5. 生成追溯报告

### 场景3: 批量缺陷处理
1. 统计缺陷分布
2. 分析共性原因
3. 批量判定处置
4. 建立预防措施
5. 通知相关人员

---

## 质量数据分析

### 关键指标
- **一次通过率 (FPY)**: 首次检验通过的比例
- **缺陷率**: 缺陷数量占总产量的比例
- **返工率**: 需要返工的产品比例
- **报废率**: 报废产品的比例

### 分析维度
- 按产品型号
- 按产线/工位
- 按时间段
- 按缺陷类型

---

## 与其他角色的协作

| 协作角色 | 协作内容 |
|----------|----------|
| 工艺工程师 | 工艺问题分析，检验规范制定 |
| 产线组长 | 现场质量问题沟通，首件协调 |
| 操作员 | 操作规范指导，质量培训 |
| 生产计划员 | 质量问题对交期的影响评估 |

---

## 注意事项

1. **及时处置**: 缺陷发现后应及时处置，避免影响扩大
2. **完整记录**: 所有质量判定都应有充分的记录和依据
3. **追溯完整性**: 确保追溯数据的完整性和准确性
4. **数据保密**: 追溯数据可能涉及客户信息，注意保密
5. **持续改进**: 从质量数据中发现规律，推动持续改进
