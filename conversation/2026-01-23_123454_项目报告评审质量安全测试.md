# 项目报告评审（质量/安全/测试）

## Context
- 用户提供了一份针对本仓库（`apps/server` + `apps/web`）的工程成熟度报告（lint/typecheck/formatter/CI/docs/observability/security/testing 等维度评分），并询问“看看这份报告”。
- 报告的核心结论：代码风格与构建体系较完善，但缺少测试与若干安全/协作护栏（pre-commit、branch protection、secret scanning、CODEOWNERS、依赖更新自动化等）。

## Decisions
- 不引入仓库级“硬性” pre-commit hooks（团队已通过 Skills/既有工作流完成本地质量检查，不希望增加 git hook 约束）。
- 质量门槛优先放在 CI/PR：通过 CI 跑 `bun run lint` + `bun run check-types`，并用 main 分支保护将其作为必需状态检查。

## Plan
- 引入测试：Vitest 基础架构 + 1-3 个关键模块的最小单测/冒烟测；补充 `bun run test` 脚本与 CI 任务。
- 配置仓库护栏：main 分支保护（必需 PR review + 必需状态检查）+ 启用 secret scanning + 增加 CODEOWNERS（可选）。

## Findings
- ✅ 已具备：Biome lint/format、严格 TS、`bun.lock` 固定依赖、README 构建说明清晰、CI 快、OpenAPI 文档、/health、traceId 传播。
- ⚠️ 风险缺口：完全没有测试与测试命令；缺少 pre-commit 导致质量门槛仅依赖 CI；main 无分支保护/secret scanning/CODEOWNERS/依赖更新自动化，存在误合并与供应链风险敞口。
- 📌 报告给出的 Action Items 与现状匹配：1) pre-commit 2) Vitest 3) branch protection。

## Progress
- 仅记录评审结论，尚未在仓库内落地改动。

## Errors
- 无

## Open Questions
- 先做哪一项：pre-commit / Vitest / branch protection？
- 如果做 branch protection：是否要求“必须通过 `bun run lint` + `bun run check-types`”的状态检查？是否需要至少 1 位 reviewer？
- 如果做测试：首批要覆盖哪些“关键服务/关键流程”（server 的 service/util，还是 web 的关键 hooks/表单校验）？

## References
- `AGENTS.md`（本仓库工作流与验证要求）
